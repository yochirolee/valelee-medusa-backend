import{I as Ue}from"./chunk-PYIO3TDQ-D8Zv8hXV.js";import{g as T}from"./chunk-PDWBYQOW-BedvhUOI.js";import{D as He,I as ce,h as he,e as Xe,f as Ze,g as Ye,a as xe}from"./chunk-53RYGJCD-H-N7MA2x.js";import{c as Je}from"./chunk-MWVM4TYO-bKUcYSnf.js";import{c as w}from"./chunk-6GU6IDUA-CDc7wW5L.js";import{K as Qe}from"./chunk-6HTZNHPT-AiCRXI8I.js";import{S as R}from"./chunk-4TC5YS65-WmRz150Y.js";import{r as u,j as o,bB as et,cK as tt,ez as ge,aM as _,bZ as nt,b7 as ot,b8 as st,b9 as rt,a2 as G,ae as Z,a4 as F,af as I,bn as M,ad as ve,ao as be,b as z,cp as it,a8 as at,a9 as lt,y as ct,w as y,H as dt,T as q,B as Y,m as je,I as te,b4 as ut,D as k,W as pt,X as mt,v as $,V as ft,bc as ht,z as J,Y as A,C as xt}from"./index-B1ljKk9e.js";import{f as se,C as gt}from"./index.esm-DJCiCQY0.js";import{X as vt}from"./x-mark-mini-EeQGs_oW.js";import{T as Q}from"./Trans-Y4jTvMvS.js";import{C as V}from"./currency-input-CXs11IuU.js";var bt=Object.defineProperty,K=Object.getOwnPropertySymbols,Ce=Object.prototype.hasOwnProperty,ye=Object.prototype.propertyIsEnumerable,de=(e,n,t)=>n in e?bt(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,jt=(e,n)=>{for(var t in n)Ce.call(n,t)&&de(e,t,n[t]);if(K)for(var t of K(n))ye.call(n,t)&&de(e,t,n[t]);return e},Ct=(e,n)=>{var t={};for(var s in e)Ce.call(e,s)&&n.indexOf(s)<0&&(t[s]=e[s]);if(e!=null&&K)for(var s of K(e))n.indexOf(s)<0&&ye.call(e,s)&&(t[s]=e[s]);return t};const _e=u.forwardRef((e,n)=>{var t=e,{color:s="currentColor"}=t,r=Ct(t,["color"]);return u.createElement("svg",jt({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:n},r),u.createElement("path",{stroke:s,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9.056 1.944h4v4M13.056 1.944l-4 4M1.944 9.056v4h4M1.944 13.056l4-4"}))});_e.displayName="ArrowsPointingOut";var yt=Object.defineProperty,B=Object.getOwnPropertySymbols,we=Object.prototype.hasOwnProperty,Pe=Object.prototype.propertyIsEnumerable,ue=(e,n,t)=>n in e?yt(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,_t=(e,n)=>{for(var t in n)we.call(n,t)&&ue(e,t,n[t]);if(B)for(var t of B(n))Pe.call(n,t)&&ue(e,t,n[t]);return e},wt=(e,n)=>{var t={};for(var s in e)we.call(e,s)&&n.indexOf(s)<0&&(t[s]=e[s]);if(e!=null&&B)for(var s of B(e))n.indexOf(s)<0&&Pe.call(e,s)&&(t[s]=e[s]);return t};const Ne=u.forwardRef((e,n)=>{var t=e,{color:s="currentColor"}=t,r=wt(t,["color"]);return u.createElement("svg",_t({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:n},r),u.createElement("path",{stroke:s,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7.5 13.945a6.444 6.444 0 1 0 0-12.89 6.444 6.444 0 0 0 0 12.89M8.167 5.5h2.666M4.167 5.5h1.777M5.944 3.944v3.111M9.056 9.5h1.777M4.167 9.5h2.666M9.056 7.944v3.111"}))});Ne.displayName="CircleSliders";function Pt(e,n=[]){let t=[];function s(i,a){const l=u.createContext(a),c=t.length;t=[...t,a];const d=p=>{var P;const{scope:m,children:x,...h}=p,g=((P=m==null?void 0:m[e])==null?void 0:P[c])||l,j=u.useMemo(()=>h,Object.values(h));return o.jsx(g.Provider,{value:j,children:x})};d.displayName=i+"Provider";function f(p,m){var g;const x=((g=m==null?void 0:m[e])==null?void 0:g[c])||l,h=u.useContext(x);if(h)return h;if(a!==void 0)return a;throw new Error(`\`${p}\` must be used within \`${i}\``)}return[d,f]}const r=()=>{const i=t.map(a=>u.createContext(a));return function(l){const c=(l==null?void 0:l[e])||i;return u.useMemo(()=>({[`__scope${e}`]:{...l,[e]:c}}),[l,c])}};return r.scopeName=e,[s,Nt(r,...n)]}function Nt(...e){const n=e[0];if(e.length===1)return n;const t=()=>{const s=e.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(i){const a=s.reduce((l,{useScope:c,scopeName:d})=>{const p=c(i)[`__scope${d}`];return{...l,...p}},{});return u.useMemo(()=>({[`__scope${n.scopeName}`]:a}),[a])}};return t.scopeName=n.scopeName,t}function pe(e,n){if(typeof e=="function")return e(n);e!=null&&(e.current=n)}function Oe(...e){return n=>{let t=!1;const s=e.map(r=>{const i=pe(r,n);return!t&&typeof i=="function"&&(t=!0),i});if(t)return()=>{for(let r=0;r<s.length;r++){const i=s[r];typeof i=="function"?i():pe(e[r],null)}}}}function Ot(...e){return u.useCallback(Oe(...e),e)}function St(e,n,{checkForDefaultPrevented:t=!0}={}){return function(r){if(e==null||e(r),t===!1||!r.defaultPrevented)return n==null?void 0:n(r)}}function Se(e){const n=u.useRef(e);return u.useEffect(()=>{n.current=e}),u.useMemo(()=>(...t)=>{var s;return(s=n.current)==null?void 0:s.call(n,...t)},[])}function Re({prop:e,defaultProp:n,onChange:t=()=>{}}){const[s,r]=Rt({defaultProp:n,onChange:t}),i=e!==void 0,a=i?e:s,l=Se(t),c=u.useCallback(d=>{if(i){const p=typeof d=="function"?d(e):d;p!==e&&l(p)}else r(d)},[i,e,r,l]);return[a,c]}function Rt({defaultProp:e,onChange:n}){const t=u.useState(e),[s]=t,r=u.useRef(s),i=Se(n);return u.useEffect(()=>{r.current!==s&&(i(s),r.current=s)},[s,r,i]),t}var Ae=u.forwardRef((e,n)=>{const{children:t,...s}=e,r=u.Children.toArray(t),i=r.find(It);if(i){const a=i.props.children,l=r.map(c=>c===i?u.Children.count(a)>1?u.Children.only(null):u.isValidElement(a)?a.props.children:null:c);return o.jsx(ne,{...s,ref:n,children:u.isValidElement(a)?u.cloneElement(a,void 0,l):null})}return o.jsx(ne,{...s,ref:n,children:t})});Ae.displayName="Slot";var ne=u.forwardRef((e,n)=>{const{children:t,...s}=e;if(u.isValidElement(t)){const r=Et(t);return u.cloneElement(t,{...kt(s,t.props),ref:n?Oe(n,r):r})}return u.Children.count(t)>1?u.Children.only(null):null});ne.displayName="SlotClone";var At=({children:e})=>o.jsx(o.Fragment,{children:e});function It(e){return u.isValidElement(e)&&e.type===At}function kt(e,n){const t={...n};for(const s in n){const r=e[s],i=n[s];/^on[A-Z]/.test(s)?r&&i?t[s]=(...l)=>{i(...l),r(...l)}:r&&(t[s]=r):s==="style"?t[s]={...r,...i}:s==="className"&&(t[s]=[r,i].filter(Boolean).join(" "))}return{...e,...t}}function Et(e){var s,r;let n=(s=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:s.get,t=n&&"isReactWarning"in n&&n.isReactWarning;return t?e.ref:(n=(r=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:r.get,t=n&&"isReactWarning"in n&&n.isReactWarning,t?e.props.ref:e.props.ref||e.ref)}var Lt=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Ie=Lt.reduce((e,n)=>{const t=u.forwardRef((s,r)=>{const{asChild:i,...a}=s,l=i?Ae:n;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),o.jsx(l,{...a,ref:r})});return t.displayName=`Primitive.${n}`,{...e,[n]:t}},{}),Tt=globalThis!=null&&globalThis.document?u.useLayoutEffect:()=>{},Mt=et.useId||(()=>{}),Vt=0;function Dt(e){const[n,t]=u.useState(Mt());return Tt(()=>{t(s=>s??String(Vt++))},[e]),n?`radix-${n}`:""}var N="Accordion",$t=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[re,zt,Ft]=tt(N),[U,Sn]=Pt(N,[Ft,ge]),ie=ge(),ke=_.forwardRef((e,n)=>{const{type:t,...s}=e,r=s,i=s;return o.jsx(re.Provider,{scope:e.__scopeAccordion,children:t==="multiple"?o.jsx(Wt,{...i,ref:n}):o.jsx(Bt,{...r,ref:n})})});ke.displayName=N;var[Ee,qt]=U(N),[Le,Kt]=U(N,{collapsible:!1}),Bt=_.forwardRef((e,n)=>{const{value:t,defaultValue:s,onValueChange:r=()=>{},collapsible:i=!1,...a}=e,[l,c]=Re({prop:t,defaultProp:s,onChange:r});return o.jsx(Ee,{scope:e.__scopeAccordion,value:l?[l]:[],onItemOpen:c,onItemClose:_.useCallback(()=>i&&c(""),[i,c]),children:o.jsx(Le,{scope:e.__scopeAccordion,collapsible:i,children:o.jsx(Te,{...a,ref:n})})})}),Wt=_.forwardRef((e,n)=>{const{value:t,defaultValue:s,onValueChange:r=()=>{},...i}=e,[a=[],l]=Re({prop:t,defaultProp:s,onChange:r}),c=_.useCallback(f=>l((p=[])=>[...p,f]),[l]),d=_.useCallback(f=>l((p=[])=>p.filter(m=>m!==f)),[l]);return o.jsx(Ee,{scope:e.__scopeAccordion,value:a,onItemOpen:c,onItemClose:d,children:o.jsx(Le,{scope:e.__scopeAccordion,collapsible:!0,children:o.jsx(Te,{...i,ref:n})})})}),[Gt,H]=U(N),Te=_.forwardRef((e,n)=>{const{__scopeAccordion:t,disabled:s,dir:r,orientation:i="vertical",...a}=e,l=_.useRef(null),c=Ot(l,n),d=zt(t),p=nt(r)==="ltr",m=St(e.onKeyDown,x=>{var E;if(!$t.includes(x.key))return;const h=x.target,g=d().filter(L=>{var le;return!((le=L.ref.current)!=null&&le.disabled)}),j=g.findIndex(L=>L.ref.current===h),P=g.length;if(j===-1)return;x.preventDefault();let C=j;const v=0,O=P-1,b=()=>{C=j+1,C>O&&(C=v)},S=()=>{C=j-1,C<v&&(C=O)};switch(x.key){case"Home":C=v;break;case"End":C=O;break;case"ArrowRight":i==="horizontal"&&(p?b():S());break;case"ArrowDown":i==="vertical"&&b();break;case"ArrowLeft":i==="horizontal"&&(p?S():b());break;case"ArrowUp":i==="vertical"&&S();break}const X=C%P;(E=g[X].ref.current)==null||E.focus()});return o.jsx(Gt,{scope:t,disabled:s,direction:r,orientation:i,children:o.jsx(re.Slot,{scope:t,children:o.jsx(Ie.div,{...a,"data-orientation":i,ref:c,onKeyDown:s?void 0:m})})})}),W="AccordionItem",[Ut,ae]=U(W),Me=_.forwardRef((e,n)=>{const{__scopeAccordion:t,value:s,...r}=e,i=H(W,t),a=qt(W,t),l=ie(t),c=Dt(),d=s&&a.value.includes(s)||!1,f=i.disabled||e.disabled;return o.jsx(Ut,{scope:t,open:d,disabled:f,triggerId:c,children:o.jsx(ot,{"data-orientation":i.orientation,"data-state":Fe(d),...l,...r,ref:n,disabled:f,open:d,onOpenChange:p=>{p?a.onItemOpen(s):a.onItemClose(s)}})})});Me.displayName=W;var Ve="AccordionHeader",Ht=_.forwardRef((e,n)=>{const{__scopeAccordion:t,...s}=e,r=H(N,t),i=ae(Ve,t);return o.jsx(Ie.h3,{"data-orientation":r.orientation,"data-state":Fe(i.open),"data-disabled":i.disabled?"":void 0,...s,ref:n})});Ht.displayName=Ve;var oe="AccordionTrigger",De=_.forwardRef((e,n)=>{const{__scopeAccordion:t,...s}=e,r=H(N,t),i=ae(oe,t),a=Kt(oe,t),l=ie(t);return o.jsx(re.ItemSlot,{scope:t,children:o.jsx(st,{"aria-disabled":i.open&&!a.collapsible||void 0,"data-orientation":r.orientation,id:i.triggerId,...l,...s,ref:n})})});De.displayName=oe;var $e="AccordionContent",ze=_.forwardRef((e,n)=>{const{__scopeAccordion:t,...s}=e,r=H(N,t),i=ae($e,t),a=ie(t);return o.jsx(rt,{role:"region","aria-labelledby":i.triggerId,"data-orientation":r.orientation,...a,...s,ref:n,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...e.style}})});ze.displayName=$e;function Fe(e){return e?"open":"closed"}var Xt=ke,Zt=Me,Yt=De,Jt=ze,Qt=(e,n,t)=>({attribute:e,operator:n,value:w(t)}),Rn=e=>[{value:e.gte,operator:"gte"},{value:e.lte,operator:"lte"},{value:e.gt,operator:"gt"},{value:e.lt,operator:"lt"},{value:e.eq,operator:"eq"}].filter(({value:s})=>s).map(({operator:s,value:r})=>Qt(Ue,s,r)),qe=G({amount:Z([F(),I()]),gte:Z([F(),I()]).nullish(),lte:Z([F(),I()]).nullish(),lt:I().nullish(),gt:I().nullish(),eq:I().nullish()}).refine(e=>e.amount!=="",{message:M("stockLocations.shippingOptions.conditionalPrices.errors.amountRequired"),path:["amount"]}).refine(e=>e.eq!==void 0||e.lt!==void 0||e.gt!==void 0?!0:e.gte!==void 0&&e.gte!==""||e.lte!==void 0&&e.lte!=="",{message:M("stockLocations.shippingOptions.conditionalPrices.errors.minOrMaxRequired"),path:["gte"]}).refine(e=>{if(e.gte!=null&&e.gte!==""&&e.lte!=null&&e.lte!==""){const n=w(e.gte),t=w(e.lte);return n<=t}return!0},{message:M("stockLocations.shippingOptions.conditionalPrices.errors.minGreaterThanMax"),path:["gte"]}),en=qe.and(G({id:F().optional()}));function Ke(e,n){const t=e.prices;for(let s=0;s<t.length;s++)for(let r=s+1;r<t.length;r++){const i=t[s],a=t[r];if(i.amount===""||a.amount==="")continue;const l=w(i.amount),c=w(a.amount);l===c&&on(n,r),[{value:i.gte,type:"gte"},{value:i.lte,type:"lte"},{value:i.eq,type:"eq"},{value:i.lt,type:"lt"},{value:i.gt,type:"gt"}].forEach(f=>{if(!f.value&&f.value!==0)return;[{value:a.gte,type:"gte"},{value:a.lte,type:"lte"},{value:a.eq,type:"eq"},{value:a.lt,type:"lt"},{value:a.gt,type:"gt"}].forEach(m=>{if(!m.value&&m.value!==0)return;const x=w(f.value),h=w(m.value);x===h&&sn(n,r,m.type)})})}}var tn=G({prices:ve(qe)}).superRefine(Ke),nn=G({prices:ve(en)}).superRefine(Ke),on=(e,n)=>{e.addIssue({code:be.custom,message:M("stockLocations.shippingOptions.conditionalPrices.errors.duplicateAmount"),path:["prices",n,"amount"]})},sn=(e,n,t)=>{e.addIssue({code:be.custom,message:M("stockLocations.shippingOptions.conditionalPrices.errors.overlappingConditions"),path:["prices",n,t]})},Be=u.createContext(null),An=({children:e,onOpenConditionalPricesModal:n,onCloseConditionalPricesModal:t})=>o.jsx(Be.Provider,{value:{onOpenConditionalPricesModal:n,onCloseConditionalPricesModal:t},children:e}),We=()=>{const e=u.useContext(Be);if(!e)throw new Error("useShippingOptionPrice must be used within a ShippingOptionPriceProvider");return e},Ge=(e,n)=>{const t=n==="region"?"region_prices":"currency_prices",s=n==="region"?"conditional_region_prices":"conditional_currency_prices";return e.replace(t,s)},rn="rule-item",D=e=>`${rn}-${e}`,In=({info:e,variant:n})=>{const{t}=z(),{getValues:s,setValue:r}=it(),{onCloseConditionalPricesModal:i}=We(),[a,l]=u.useState([D(0)]),{field:c,type:d,currency:f,name:p}=e,m=Ge(c,d),x=at({defaultValues:{prices:s(m)||[{amount:"",gte:"",lte:null}]},resolver:lt(n==="create"?tn:nn)}),{fields:h,append:g,remove:j}=ct({control:x.control,name:"prices"}),P=()=>{g({amount:"",gte:"",lte:null}),l([...a,D(h.length)])},C=b=>{j(b)},v=x.handleSubmit(b=>{r(m,b.prices,{shouldDirty:!0,shouldValidate:!0,shouldTouch:!0}),i()},b=>{const S=Object.keys(b.prices||{});l(X=>{const E=new Set(X);return S.forEach(L=>{E.add(D(Number(L)))}),Array.from(E)})}),O=b=>{b.key==="Enter"&&(b.metaKey||b.ctrlKey)&&(console.log("Fired"),b.preventDefault(),b.stopPropagation(),v())};return o.jsx(y,{...x,children:o.jsx(Qe,{onSubmit:v,onKeyDown:O,className:"flex h-full flex-col",children:o.jsxs(R.Content,{children:[o.jsx(R.Header,{}),o.jsx(R.Body,{className:"size-full overflow-hidden",children:o.jsx("div",{className:"flex size-full flex-1 flex-col items-center overflow-y-auto",children:o.jsx("div",{className:"flex w-full max-w-[720px] flex-col gap-y-8 px-6 py-16",children:o.jsxs("div",{className:"flex w-full flex-col gap-y-6",children:[o.jsxs("div",{children:[o.jsx(R.Title,{asChild:!0,children:o.jsx(dt,{children:t("stockLocations.shippingOptions.conditionalPrices.header",{name:p})})}),o.jsx(R.Description,{asChild:!0,children:o.jsx(q,{size:"small",className:"text-ui-fg-subtle",children:t("stockLocations.shippingOptions.conditionalPrices.description")})})]}),o.jsx(an,{value:a,onValueChange:l,children:h.map((b,S)=>o.jsx(ln,{index:S,onRemove:C,currency:f,control:x.control},b.id))}),o.jsx("div",{className:"flex items-center justify-end",children:o.jsx(Y,{variant:"secondary",size:"small",type:"button",onClick:P,children:t("stockLocations.shippingOptions.conditionalPrices.actions.addPrice")})})]})})})}),o.jsx(R.Footer,{children:o.jsxs("div",{className:"flex items-center justify-end gap-2",children:[o.jsx(R.Close,{asChild:!0,children:o.jsx(Y,{variant:"secondary",size:"small",type:"button",children:t("actions.cancel")})}),o.jsx(Y,{size:"small",type:"button",onClick:v,children:t("actions.save")})]})})]})})})},an=({children:e,value:n,onValueChange:t})=>o.jsx(Xt,{type:"multiple",defaultValue:[D(0)],value:n,onValueChange:t,className:"flex flex-col gap-y-3",children:e}),ln=({index:e,currency:n,onRemove:t,control:s})=>{const{t:r}=z(),i=a=>{a.stopPropagation(),t(e)};return o.jsxs(Zt,{value:D(e),className:je("bg-ui-bg-component shadow-elevation-card-rest rounded-lg"),children:[o.jsx(Yt,{asChild:!0,children:o.jsxs("div",{className:"group/trigger flex w-full cursor-pointer items-start justify-between gap-x-2 p-3",children:[o.jsxs("div",{className:"flex flex-1 flex-wrap items-center justify-between gap-2",children:[o.jsx("div",{className:"flex h-7 items-center",children:o.jsx(dn,{index:e,currency:n,control:s})}),o.jsx("div",{className:"flex min-h-7 items-center",children:o.jsx(un,{index:e,currency:n,control:s})})]}),o.jsxs("div",{className:"flex items-center gap-x-2",children:[o.jsx(te,{size:"small",variant:"transparent",className:"text-ui-fg-muted hover:text-ui-fg-subtle focus-visible:text-ui-fg-subtle",onClick:i,children:o.jsx(vt,{})}),o.jsx(te,{size:"small",variant:"transparent",className:"text-ui-fg-muted hover:text-ui-fg-subtle focus-visible:text-ui-fg-subtle",children:o.jsx(ut,{className:"transition-transform group-data-[state=open]/trigger:rotate-180"})})]})]})}),o.jsxs(Jt,{className:"text-ui-fg-subtle",children:[o.jsx(k,{variant:"dashed"}),o.jsx(y.Field,{control:s,name:`prices.${e}.amount`,render:({field:{value:a,onChange:l,...c}})=>o.jsx(y.Item,{children:o.jsxs("div",{className:"grid grid-cols-2 items-start gap-x-2 p-3",children:[o.jsx("div",{className:"flex h-8 items-center",children:o.jsx(y.Label,{children:r("stockLocations.shippingOptions.conditionalPrices.rules.amount")})}),o.jsxs("div",{className:"flex flex-col gap-y-1",children:[o.jsx(y.Control,{children:o.jsx(V,{className:"bg-ui-bg-field-component hover:bg-ui-bg-field-component-hover focus-visible:bg-ui-bg-field-component-hover",placeholder:se({value:"0",decimalScale:n.decimal_digits}),decimalScale:n.decimal_digits,symbol:n.symbol_native,code:n.code,value:a,onValueChange:(d,f,p)=>l(p!=null&&p.value?p==null?void 0:p.value:""),autoFocus:!0,...c})}),o.jsx(y.ErrorMessage,{})]})]})})}),o.jsx(k,{variant:"dashed"}),o.jsx(y.Field,{control:s,name:`prices.${e}.gte`,render:({field:a})=>o.jsx(me,{field:a,label:r("stockLocations.shippingOptions.conditionalPrices.rules.gte"),currency:n,placeholder:"1000"})}),o.jsx(k,{variant:"dashed"}),o.jsx(y.Field,{control:s,name:`prices.${e}.lte`,render:({field:a})=>o.jsx(me,{field:a,label:r("stockLocations.shippingOptions.conditionalPrices.rules.lte"),currency:n,placeholder:"1000"})}),o.jsx(cn,{index:e,control:s,currency:n})]})]})},me=({field:e,label:n,currency:t,placeholder:s})=>{const r=u.useRef(null),{value:i,onChange:a,ref:l,...c}=e,d=he(r,l),f=()=>{if(i===null){a(""),requestAnimationFrame(()=>{var m;(m=r.current)==null||m.focus()});return}a(null)},p=i===null;return o.jsx(y.Item,{children:o.jsxs("div",{className:"grid grid-cols-2 items-start gap-x-2 p-3",children:[o.jsxs("div",{className:"flex h-8 items-center gap-x-1",children:[o.jsx(te,{size:"2xsmall",variant:"transparent",onClick:f,children:p?o.jsx(pt,{}):o.jsx(mt,{})}),o.jsx(y.Label,{children:n})]}),!p&&o.jsxs("div",{className:"flex flex-col gap-y-1",children:[o.jsx(y.Control,{children:o.jsx(V,{className:"bg-ui-bg-field-component hover:bg-ui-bg-field-component-hover focus-visible:bg-ui-bg-field-component-hover",placeholder:se({value:s,decimalScale:t.decimal_digits}),decimalScale:t.decimal_digits,symbol:t.symbol_native,code:t.code,value:i,ref:d,onValueChange:(m,x,h)=>a(h!=null&&h.value?h==null?void 0:h.value:""),...c})}),o.jsx(y.ErrorMessage,{})]})]})})},cn=({index:e,control:n,currency:t})=>{const{t:s}=z(),r=$({control:n,name:`prices.${e}`});return r.eq==null&&r.gt==null&&r.lt==null?null:o.jsxs("div",{children:[o.jsx(k,{variant:"dashed"}),o.jsxs("div",{className:"flex items-center gap-x-1 px-3 pt-3",children:[o.jsx(q,{size:"small",leading:"compact",weight:"plus",children:s("stockLocations.shippingOptions.conditionalPrices.customRules.label")}),o.jsx(ft,{content:s("stockLocations.shippingOptions.conditionalPrices.customRules.tooltip"),children:o.jsx(ht,{className:"text-ui-fg-muted"})})]}),o.jsxs("div",{children:[r.eq!=null&&o.jsxs("div",{className:"grid grid-cols-2 items-start gap-x-2 p-3",children:[o.jsx("div",{className:"flex h-8 items-center",children:o.jsx(J,{weight:"plus",size:"small",children:s("stockLocations.shippingOptions.conditionalPrices.customRules.eq")})}),o.jsx(V,{className:"bg-ui-bg-field-component hover:bg-ui-bg-field-component-hover focus-visible:bg-ui-bg-field-component-hover",symbol:t.symbol_native,code:t.code,value:r.eq,disabled:!0})]}),r.gt!=null&&o.jsxs(u.Fragment,{children:[o.jsx(k,{variant:"dashed"}),o.jsxs("div",{className:"grid grid-cols-2 items-start gap-x-2 p-3",children:[o.jsx("div",{className:"flex h-8 items-center",children:o.jsx(J,{weight:"plus",size:"small",children:s("stockLocations.shippingOptions.conditionalPrices.customRules.gt")})}),o.jsx(V,{className:"bg-ui-bg-field-component hover:bg-ui-bg-field-component-hover focus-visible:bg-ui-bg-field-component-hover",symbol:t.symbol_native,code:t.code,value:r.gt,disabled:!0})]})]}),r.lt!=null&&o.jsxs(u.Fragment,{children:[o.jsx(k,{variant:"dashed"}),o.jsxs("div",{className:"grid grid-cols-2 items-start gap-x-2 p-3",children:[o.jsx("div",{className:"flex h-8 items-center",children:o.jsx(J,{weight:"plus",size:"small",children:s("stockLocations.shippingOptions.conditionalPrices.customRules.lt")})}),o.jsx(V,{className:"bg-ui-bg-field-component hover:bg-ui-bg-field-component-hover focus-visible:bg-ui-bg-field-component-hover",symbol:t.symbol_native,code:t.code,value:r.lt,disabled:!0})]})]})]})]})},dn=({index:e,currency:n,control:t})=>{const s=$({control:t,name:`prices.${e}.amount`});if(s===""||s===void 0)return o.jsx(q,{size:"small",weight:"plus",children:"-"});const r=w(s);return o.jsx(q,{size:"small",weight:"plus",children:T(r,n.code)})},ee=({children:e})=>o.jsx("div",{className:"text-ui-fg-subtle txt-small flex flex-wrap items-center gap-1.5",children:e}),un=({index:e,currency:n,control:t})=>{const{t:s,i18n:r}=z(),i=$({control:t,name:`prices.${e}.gte`}),a=$({control:t,name:`prices.${e}.lte`});return(()=>{const c=i?w(i):void 0,d=a?w(a):void 0;return!c&&!d?null:c&&!d?o.jsx(ee,{children:o.jsx(Q,{i18n:r,i18nKey:"stockLocations.shippingOptions.conditionalPrices.summaries.greaterThan",components:[o.jsx(A,{size:"2xsmall"},"attribute"),o.jsx(A,{size:"2xsmall"},"gte")],values:{attribute:s("stockLocations.shippingOptions.conditionalPrices.attributes.cartItemTotal"),gte:T(c,n.code)}})}):!c&&d?o.jsx(ee,{children:o.jsx(Q,{i18n:r,i18nKey:"stockLocations.shippingOptions.conditionalPrices.summaries.lessThan",components:[o.jsx(A,{size:"2xsmall"},"attribute"),o.jsx(A,{size:"2xsmall"},"lte")],values:{attribute:s("stockLocations.shippingOptions.conditionalPrices.attributes.cartItemTotal"),lte:T(d,n.code)}})}):c&&d?o.jsx(ee,{children:o.jsx(Q,{i18n:r,i18nKey:"stockLocations.shippingOptions.conditionalPrices.summaries.range",components:[o.jsx(A,{size:"2xsmall"},"attribute"),o.jsx(A,{size:"2xsmall"},"gte"),o.jsx(A,{size:"2xsmall"},"lte")],values:{attribute:s("stockLocations.shippingOptions.conditionalPrices.attributes.cartItemTotal"),gte:T(c,n.code),lte:T(d,n.code)}})}):null})()},fe=({context:e,code:n,header:t,type:s})=>{const[r,i]=u.useState(0),a=u.useCallback(g=>{if(g){const j=g.offsetWidth;i(j)}},[]),{field:l,control:c,renderProps:d}=Xe({context:e}),f=Ze({context:e}),{container:p,input:m}=d,{isAnchor:x}=p,h=Je[n.toUpperCase()];return o.jsx(xt,{control:c,name:l,render:({field:g})=>o.jsx(Ye,{...p,...f,outerComponent:o.jsx(pn,{header:t,isAnchor:x,field:l,control:c,symbolWidth:r,type:s,currency:h}),children:o.jsx(mn,{field:g,inputProps:m,currencyInfo:h,onMeasureSymbol:a})})})},pn=({isAnchor:e,header:n,field:t,control:s,symbolWidth:r,type:i,currency:a})=>{const{onOpenConditionalPricesModal:l}=We(),c=u.useRef(null),d=Ge(t,i),f=$({control:s,name:d});return u.useEffect(()=>{const p=m=>{var x;e&&(m.metaKey||m.ctrlKey)&&m.key.toLowerCase()==="b"&&(m.preventDefault(),(x=c.current)==null||x.click())};return document.addEventListener("keydown",p),()=>document.removeEventListener("keydown",p)},[e]),o.jsxs("div",{className:"absolute inset-y-0 z-[3] flex w-fit items-center justify-center",style:{left:r?`${r+16+4}px`:void 0},children:[(f==null?void 0:f.length)>0&&!e&&o.jsx("div",{className:"flex size-[15px] items-center justify-center group-hover/container:hidden",children:o.jsx(Ne,{className:"text-ui-fg-interactive"})}),o.jsx("button",{ref:c,type:"button",className:je("hover:text-ui-fg-subtle text-ui-fg-muted transition-fg hidden size-[15px] items-center justify-center rounded-md bg-transparent group-hover/container:flex",{flex:e}),onClick:()=>l({type:i,field:t,currency:a,name:n}),children:o.jsx(_e,{})})]})},mn=({field:e,onMeasureSymbol:n,inputProps:t,currencyInfo:s})=>{const{value:r,onChange:i,onBlur:a,ref:l,...c}=e,{ref:d,onBlur:f,onFocus:p,onChange:m,...x}=t,h=u.useCallback(v=>{const O=typeof v=="number"?v.toString():v||"";return se({value:O,decimalScale:s.decimal_digits,disableGroupSeparators:!0,decimalSeparator:"."})},[s]),[g,j]=u.useState(r||""),P=(v,O,b)=>{if(!v){j("");return}j(v)};u.useEffect(()=>{let v=r;isNaN(Number(r))||(v=h(v)),j(v)},[r,h]);const C=he(d,l);return o.jsxs("div",{className:"relative flex size-full items-center",children:[o.jsx("span",{className:"txt-compact-small text-ui-fg-muted pointer-events-none absolute left-0 w-fit min-w-4","aria-hidden":!0,ref:n,children:s.symbol_native}),o.jsx(gt,{...c,...x,ref:C,className:"txt-compact-small w-full flex-1 cursor-default appearance-none bg-transparent pl-[60px] text-right outline-none",value:g||void 0,onValueChange:P,formatValueOnBlur:!0,onBlur:()=>{a(),f(),m(g,r)},onFocus:p,decimalScale:s.decimal_digits,decimalsLimit:s.decimal_digits,autoComplete:"off",tabIndex:-1})]})},fn=xe(),kn=({name:e,currencies:n=[],regions:t=[],pricePreferences:s=[]})=>{const{t:r}=z();return u.useMemo(()=>[fn.column({id:"name",name:r("fields.name"),disableHiding:!0,header:r("fields.name"),cell:i=>o.jsx(He.ReadonlyCell,{context:i,children:e})}),...hn({currencies:n,regions:t,pricePreferences:s,getFieldName:(i,a)=>{var l;return(l=i.column.id)!=null&&l.startsWith("currency_prices")?`currency_prices.${a}`:`region_prices.${a}`},t:r})],[r,n,t,s,e])},hn=({currencies:e,regions:n,pricePreferences:t,getFieldName:s,t:r})=>{const i=xe();return[...(e==null?void 0:e.map(a=>{const l=t==null?void 0:t.find(d=>d.attribute==="currency_code"&&d.value===a),c=r("fields.priceTemplate",{regionOrCurrency:a.toUpperCase()});return i.column({id:`currency_prices.${a}`,name:r("fields.priceTemplate",{regionOrCurrency:a.toUpperCase()}),field:d=>s(d,a),type:"number",header:()=>o.jsxs("div",{className:"flex w-full items-center justify-between gap-3",children:[o.jsx("span",{className:"truncate",title:c,children:c}),o.jsx(ce,{includesTax:l==null?void 0:l.is_tax_inclusive})]}),cell:d=>o.jsx(fe,{type:"currency",header:c,code:a,context:d})})}))??[],...(n==null?void 0:n.map(a=>{const l=t==null?void 0:t.find(d=>d.attribute==="region_id"&&d.value===a.id),c=r("fields.priceTemplate",{regionOrCurrency:a.name});return i.column({id:`region_prices.${a.id}`,name:r("fields.priceTemplate",{regionOrCurrency:a.name}),field:d=>s(d,a.id),type:"number",header:()=>o.jsxs("div",{className:"flex w-full items-center justify-between gap-3",children:[o.jsx("span",{className:"truncate",title:c,children:c}),o.jsx(ce,{includesTax:l==null?void 0:l.is_tax_inclusive})]}),cell:d=>(e==null?void 0:e.find(p=>p===a.currency_code))?o.jsx(fe,{type:"region",header:c,code:a.currency_code,context:d}):null})}))??[]]};export{qe as C,An as S,en as U,In as a,Rn as b,kn as u};
