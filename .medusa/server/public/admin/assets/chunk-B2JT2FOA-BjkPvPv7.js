import{D as J}from"./chunk-YEDAFXMB-BmDUuIbW.js";import{D as X}from"./chunk-AOFGTNG6-ez-DU5xt.js";import{N as Y,a as Z}from"./chunk-EMIHDNB7-CcxZpzYn.js";import{D as G}from"./chunk-GJUPECDU-C8QF8dw5.js";import{r as v,j as e,bd as _,m as b,a0 as ee,b as W,L as te}from"./index-B1ljKk9e.js";import{u as se,f as U,g as ae,a as ne,b as le}from"./index-DPedVans.js";import{T as R}from"./table-BSmpcrim.js";import{C as D}from"./command-bar-CMOg5bgQ.js";var oe=({search:s,orderBy:n,filters:i,prefix:o})=>(s||n||i||o)&&e.jsxs("div",{className:"flex items-start justify-between gap-x-4 px-6 py-4",children:[e.jsx("div",{className:"w-full max-w-[60%]",children:i&&i.length>0&&e.jsx(G,{filters:i,prefix:o})}),e.jsxs("div",{className:"flex shrink-0 items-center gap-x-2",children:[s&&e.jsx(J,{prefix:o,autofocus:s==="autofocus"}),n&&e.jsx(X,{keys:n,prefix:o})]})]}),re=({table:s,columns:n,pagination:i,navigateTo:o,commands:l,count:j=0,noResults:k=!1,noHeader:r=!1,layout:c="fit"})=>{const{t:T}=W(),[P,N]=v.useState(!1),w=v.useRef(null),p=n.find(t=>t.id==="select"),d=n.find(t=>t.id==="actions"),x=l&&l.length>0,g=s.getState().rowSelection,{pageIndex:S,pageSize:I}=s.getState().pagination,O=100/(n.length-(p?1:0)-(d?1:0)),E=t=>{t.currentTarget.scrollLeft>0?N(!0):N(!1)},A=async t=>{await t(g).then(()=>{s.resetRowSelection()})};return v.useEffect(()=>{var t;(t=w.current)==null||t.scroll({top:0,left:0})},[S]),e.jsxs("div",{className:b("flex w-full flex-col overflow-hidden",{"flex flex-1 flex-col":c==="fill"}),children:[e.jsx("div",{ref:w,onScroll:E,className:b("w-full",{"min-h-0 flex-grow overflow-auto":c==="fill","overflow-x-auto":c==="fit"}),children:k?e.jsx("div",{className:b({"border-b":c==="fit"}),children:e.jsx(Z,{})}):e.jsxs(R,{className:"relative w-full",children:[!r&&e.jsx(R.Header,{className:"border-t-0",children:s.getHeaderGroups().map(t=>e.jsx(R.Row,{className:b({"relative border-b-0 [&_th:last-of-type]:w-[1%] [&_th:last-of-type]:whitespace-nowrap":d,"[&_th:first-of-type]:w-[1%] [&_th:first-of-type]:whitespace-nowrap":p}),children:t.headers.map((a,H)=>{const m=a.id==="actions",f=a.id==="select",u=m||f,y=t.headers.findIndex(L=>L.id!=="select"),C=y!==-1?a.id===t.headers[y].id:H===0,h=f||C;return e.jsx(R.HeaderCell,{"data-table-header-id":a.id,style:{width:u?void 0:`${O}%`},className:b({"bg-ui-bg-subtle sticky left-0 after:absolute after:inset-y-0 after:right-0 after:h-full after:w-px after:bg-transparent after:content-['']":h,"left-[68px]":h&&p&&!f,"after:bg-ui-border-base":P&&h&&!u}),children:U(a.column.columnDef.header,a.getContext())},a.id)})},t.id))}),e.jsx(R.Body,{className:"border-b-0",children:s.getRowModel().rows.map(t=>{const a=o?o(t):void 0,H=p&&!t.getCanSelect(),m=t.depth%2!==0,f=t.getVisibleCells();return e.jsx(R.Row,{"data-selected":t.getIsSelected(),className:b("transition-fg group/row group relative [&_td:last-of-type]:w-[1%] [&_td:last-of-type]:whitespace-nowrap","has-[[data-row-link]:focus-visible]:bg-ui-bg-base-hover",{"bg-ui-bg-subtle hover:bg-ui-bg-subtle-hover":m,"cursor-pointer":!!a,"bg-ui-bg-highlight hover:bg-ui-bg-highlight-hover":t.getIsSelected(),"!bg-ui-bg-disabled !hover:bg-ui-bg-disabled":H}),children:f.map((u,y)=>{const C=t.getVisibleCells(),h=u.column.id==="select",L=C.findIndex(q=>q.column.id!=="select"),F=L!==-1?u.column.id===C[L].column.id:y===0,z=h||F,$=t.depth>0&&F?t.depth*14+24:void 0,Q=z&&p&&!h,V=U(u.column.columnDef.cell,u.getContext()),B=F&&!!a,K=!!a&&!h;return e.jsx(R.Cell,{className:b({"!pl-0 !pr-0":K,"bg-ui-bg-base group-data-[selected=true]/row:bg-ui-bg-highlight group-data-[selected=true]/row:group-hover/row:bg-ui-bg-highlight-hover group-hover/row:bg-ui-bg-base-hover transition-fg group-has-[[data-row-link]:focus-visible]:bg-ui-bg-base-hover sticky left-0 after:absolute after:inset-y-0 after:right-0 after:h-full after:w-px after:bg-transparent after:content-['']":z,"bg-ui-bg-subtle group-hover/row:bg-ui-bg-subtle-hover":m&&z,"left-[68px]":Q,"after:bg-ui-border-base":P&&z&&!h,"!bg-ui-bg-disabled !hover:bg-ui-bg-disabled":H}),style:{paddingLeft:$?`${$}px`:void 0},children:K?e.jsx(te,{to:a,className:"size-full outline-none","data-row-link":!0,tabIndex:B?0:-1,children:e.jsx("div",{className:b("flex size-full items-center pr-6",{"pl-6":B&&!Q}),children:V})}):V},u.id)})},t.id)})})]})}),i&&e.jsx("div",{className:b({"border-t":c==="fill"}),children:e.jsx(ie,{canNextPage:s.getCanNextPage(),canPreviousPage:s.getCanPreviousPage(),nextPage:s.nextPage,previousPage:s.previousPage,count:j,pageIndex:S,pageCount:s.getPageCount(),pageSize:I})}),x&&e.jsx(D,{open:!!Object.keys(g).length,children:e.jsxs(D.Bar,{children:[e.jsx(D.Value,{children:T("general.countSelected",{count:Object.keys(g).length})}),e.jsx(D.Seperator,{}),l==null?void 0:l.map((t,a)=>e.jsxs(v.Fragment,{children:[e.jsx(D.Command,{label:t.label,shortcut:t.shortcut,action:()=>A(t.action)}),a<l.length-1&&e.jsx(D.Seperator,{})]},a))]})})]})},ie=s=>{const{t:n}=W(),i={of:n("general.of"),results:n("general.results"),pages:n("general.pages"),prev:n("general.prev"),next:n("general.next")};return e.jsx(R.Pagination,{className:"flex-shrink-0",...s,translations:i})},ce=v.memo(oe),me=({table:s,columns:n,pagination:i,navigateTo:o,commands:l,count:j=0,search:k=!1,orderBy:r,filters:c,prefix:T,queryObject:P={},pageSize:N,isLoading:w=!1,noHeader:p=!1,layout:d="fit",noRecords:x={}})=>{if(w)return e.jsx(_,{layout:d,rowCount:N,search:!!k,filters:!!(c!=null&&c.length),orderBy:!!(r!=null&&r.length),pagination:!!i});const g=Object.values(P).filter(M=>!!M).length===0,S=!w&&j===0&&!g;return!w&&j===0&&g?e.jsx(Y,{className:b({"flex h-full flex-col overflow-hidden":d==="fill"}),...x}):e.jsxs("div",{className:b("divide-y",{"flex h-full flex-col overflow-hidden":d==="fill"}),children:[e.jsx(ce,{search:k,orderBy:r,filters:c,prefix:T}),e.jsx(re,{table:s,count:j,columns:n,pagination:!0,navigateTo:o,commands:l,noResults:S,noHeader:p,layout:d})]})},ve=({data:s=[],columns:n,count:i=0,pageSize:o=20,enablePagination:l=!0,enableRowSelection:j=!1,enableExpandableRows:k=!1,rowSelection:r,getSubRows:c,getRowId:T,meta:P,prefix:N})=>{const[w,p]=ee(),d=`${N?`${N}_`:""}offset`,x=w.get(d),[{pageIndex:g,pageSize:S},I]=v.useState({pageIndex:x?Math.ceil(Number(x)/o):0,pageSize:o}),M=v.useMemo(()=>({pageIndex:g,pageSize:S}),[g,S]),[O,E]=v.useState({}),A=(r==null?void 0:r.state)??O,t=(r==null?void 0:r.updater)??E;v.useEffect(()=>{if(!l)return;const m=x?Math.ceil(Number(x)/o):0;m!==g&&I(f=>({...f,pageIndex:m}))},[x,l,o,g]);const a=m=>{const f=m(M),{pageIndex:u,pageSize:y}=f;return p(C=>{if(!u)return C.delete(d),C;const h=new URLSearchParams(C);return h.set(d,String(u*y)),h}),I(f),f};return{table:se({data:s,columns:n,state:{rowSelection:A,pagination:l?M:void 0},pageCount:Math.ceil((i??0)/S),enableRowSelection:j,getRowId:T,getSubRows:c,onRowSelectionChange:j?t:void 0,onPaginationChange:l?a:void 0,getCoreRowModel:ae(),getPaginationRowModel:l?ne():void 0,getExpandedRowModel:k?le():void 0,manualPagination:l?!0:void 0,meta:P})}};export{me as _,ve as u};
