import{o as _,a as S}from"./chunk-ZQRKUG6J-C1MYwBrZ.js";import{F as q}from"./chunk-TYTNUPXB-BVF6SC3m.js";import{c as f}from"./chunk-6GU6IDUA-CDc7wW5L.js";import{a2 as m,a4 as i,a5 as d,an as I,a6 as T,af as P,ad as l,ao as F,ap as C,b as D,r as j,j as s,w as u}from"./index-Cny3qPON.js";var z=e=>{var t,o,h,p,c,g,y,b,k,w;const n=(o=(t=e.media)==null?void 0:t.find(r=>r.isThumbnail))==null?void 0:o.url,a=(h=e.media)==null?void 0:h.filter(r=>!r.isThumbnail).map(r=>({url:r.url}));return{status:e.status,is_giftcard:!1,tags:(p=e==null?void 0:e.tags)!=null&&p.length?(c=e.tags)==null?void 0:c.map(r=>({id:r})):void 0,sales_channels:(g=e==null?void 0:e.sales_channels)!=null&&g.length?(y=e.sales_channels)==null?void 0:y.map(r=>({id:r.id})):void 0,images:a,collection_id:e.collection_id||void 0,shipping_profile_id:e.shipping_profile_id||void 0,categories:e.categories.map(r=>({id:r})),type_id:e.type_id||void 0,handle:(b=e.handle)==null?void 0:b.trim(),origin_country:e.origin_country||void 0,material:e.material||void 0,mid_code:e.mid_code||void 0,hs_code:e.hs_code||void 0,thumbnail:n,title:e.title.trim(),subtitle:(k=e.subtitle)==null?void 0:k.trim(),description:(w=e.description)==null?void 0:w.trim(),discountable:e.discountable,width:e.width?parseFloat(e.width):void 0,length:e.length?parseFloat(e.length):void 0,height:e.height?parseFloat(e.height):void 0,weight:e.weight?parseFloat(e.weight):void 0,options:e.options.filter(r=>r.title),variants:O(e.variants.filter(r=>r.should_create),e.regionsCurrencyMap)}},O=(e,n)=>e.map(a=>({title:a.title||Object.values(a.options||{}).join(" / "),options:a.options,sku:a.sku||void 0,manage_inventory:!!a.manage_inventory,allow_backorder:!!a.allow_backorder,variant_rank:a.variant_rank,inventory_items:a.inventory.map(t=>{const o=t.required_quantity?f(t.required_quantity):null;return!t.inventory_item_id||!o?!1:{...t,required_quantity:o}}).filter(t=>t!==!1),prices:Object.entries(a.prices||{}).map(([t,o])=>{if(!(o===""||o===void 0))return t.startsWith("reg_")?{currency_code:n[t],amount:f(o),rules:{region_id:t}}:{currency_code:t,amount:f(o)}}).filter(t=>!!t)})),R=e=>e.map(n=>({...n,title:n.title||"",sku:n.sku||"",manage_inventory:n.manage_inventory||!1,allow_backorder:n.allow_backorder||!1,inventory_kit:n.inventory_kit||!1})),x=m({id:i().optional(),url:i(),isThumbnail:d(),file:I().nullable()}),M=m({should_create:d(),is_default:d().optional(),title:i(),upc:i().optional(),ean:i().optional(),barcode:i().optional(),mid_code:i().optional(),hs_code:i().optional(),width:_,height:_,length:_,weight:_,material:i().optional(),origin_country:i().optional(),sku:i().optional(),manage_inventory:d().optional(),allow_backorder:d().optional(),inventory_kit:d().optional(),options:T(i(),i()),variant_rank:P(),prices:T(i(),S).optional(),inventory:l(m({inventory_item_id:i(),required_quantity:_})).optional()}),U=m({title:i(),values:l(i()).min(1)}),W=m({title:i().min(1),subtitle:i().optional(),handle:i().optional(),description:i().optional(),discountable:d(),type_id:i().optional(),collection_id:i().optional(),shipping_profile_id:i().optional(),categories:l(i()),tags:l(i()).optional(),sales_channels:l(m({id:i(),name:i()})).optional(),origin_country:i().optional(),material:i().optional(),width:i().optional(),length:i().optional(),height:i().optional(),weight:i().optional(),mid_code:i().optional(),hs_code:i().optional(),options:l(U).min(1),enable_variants:d(),variants:l(M).min(1),media:l(x).optional()}).superRefine((e,n)=>{if(e.variants.every(t=>!t.should_create))return n.addIssue({code:F.custom,path:["variants"],message:"invalid_length"});const a=new Set;e.variants.forEach((t,o)=>{t.sku&&(a.has(t.sku)&&n.addIssue({code:F.custom,path:[`variants.${o}.sku`],message:C.t("products.create.errors.uniqueSku")}),a.add(t.sku))})}),v=m({media:l(x)}),X={discountable:!0,tags:[],sales_channels:[],options:[{title:"Default option",values:["Default option value"]}],variants:R([{title:"Default variant",should_create:!0,variant_rank:0,options:{"Default option":"Default option value"},inventory:[{inventory_item_id:"",required_quantity:""}],is_default:!0}]),enable_variants:!1,media:[],categories:[],collection_id:"",shipping_profile_id:"",description:"",handle:"",height:"",hs_code:"",length:"",material:"",mid_code:"",origin_country:"",subtitle:"",title:"",type_id:"",weight:"",width:""},E=["image/jpeg","image/png","image/gif","image/webp","image/heic","image/svg+xml"],N=[".jpeg",".png",".gif",".webp",".heic",".svg"],Z=({form:e,append:n,showHint:a=!0})=>{const{t}=D(),o=j.useCallback(p=>{const c=p.find(g=>!E.includes(g.file.type));return c?(e.setError("media",{type:"invalid_file",message:t("products.media.invalidFileType",{name:c.file.name,types:N.join(", ")})}),!0):!1},[e,t]),h=j.useCallback(p=>{e.clearErrors("media"),!o(p)&&p.forEach(c=>n({...c,isThumbnail:!1}))},[e,n,o]);return s.jsx(u.Field,{control:e.control,name:"media",render:()=>s.jsx(u.Item,{children:s.jsxs("div",{className:"flex flex-col gap-y-2",children:[s.jsxs("div",{className:"flex flex-col gap-y-1",children:[s.jsx(u.Label,{optional:!0,children:t("products.media.label")}),a&&s.jsx(u.Hint,{children:t("products.media.editHint")})]}),s.jsx(u.Control,{children:s.jsx(q,{label:t("products.media.uploadImagesLabel"),hint:t("products.media.uploadImagesHint"),hasError:!!e.formState.errors.media,formats:E,onUploaded:h})}),s.jsx(u.ErrorMessage,{})]})})})};export{v as E,X as P,Z as U,W as a,R as d,z as n};
